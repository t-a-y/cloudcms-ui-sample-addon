/**
 * @license RequireJS text 2.0.14 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

define("css!sample/gadgets/sample-products-list/sample-products-list",[],function(){}),define("text",["module"],function(e){"use strict";var t,r,s,n,a,i=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,p=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,l=c&&location.protocol&&location.protocol.replace(/\:/,""),d=c&&location.hostname,u=c&&(location.port||void 0),m={},f=e.config&&e.config()||{};return t={version:"2.0.14",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(p);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,r;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){r=i[t];try{e=new ActiveXObject(r)}catch(s){}if(e){i=[r];break}}return e},parseName:function(e){var t,r,s,n=!1,a=e.lastIndexOf("."),i=0===e.indexOf("./")||0===e.indexOf("../");return-1!==a&&(!i||a>1)?(t=e.substring(0,a),r=e.substring(a+1)):t=e,s=r||t,a=s.indexOf("!"),-1!==a&&(n="strip"===s.substring(a+1),s=s.substring(0,a),r?r=s:t=s),{moduleName:t,ext:r,strip:n}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,r,s,n){var a,i,o,p=t.xdRegExp.exec(e);return p?(a=p[2],i=p[3],i=i.split(":"),o=i[1],i=i[0],!(a&&a!==r||i&&i.toLowerCase()!==s.toLowerCase()||(o||i)&&o!==n)):!0},finishLoad:function(e,r,s,n){s=r?t.strip(s):s,f.isBuild&&(m[e]=s),n(s)},load:function(e,r,s,n){if(n&&n.isBuild&&!n.inlineText)return void s();f.isBuild=n&&n.isBuild;var a=t.parseName(e),i=a.moduleName+(a.ext?"."+a.ext:""),o=r.toUrl(i),p=f.useXhr||t.useXhr;return 0===o.indexOf("empty:")?void s():void(!c||p(o,l,d,u)?t.get(o,function(r){t.finishLoad(e,a.strip,r,s)},function(e){s.error&&s.error(e)}):r([i],function(e){t.finishLoad(a.moduleName+"."+a.ext,a.strip,e,s)}))},write:function(e,r,s,n){if(m.hasOwnProperty(r)){var a=t.jsEscape(m[r]);s.asModule(e+"!"+r,"define(function () { return '"+a+"';});\n")}},writeFile:function(e,r,s,n,a){var i=t.parseName(r),o=i.ext?"."+i.ext:"",p=i.moduleName+o,c=s.toUrl(i.moduleName+o)+".js";t.load(p,s,function(r){var s=function(e){return n(c,e)};s.asModule=function(e,t){return n.asModule(e,c,t)},t.write(e,p,s,a)},a)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(r=require.nodeRequire("fs"),t.get=function(e,t,s){try{var n=r.readFileSync(e,"utf8");"\ufeff"===n[0]&&(n=n.substring(1)),t(n)}catch(a){s&&s(a)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,r,s,n){var a,i=t.createXhr();if(i.open("GET",e,!0),n)for(a in n)n.hasOwnProperty(a)&&i.setRequestHeader(a.toLowerCase(),n[a]);f.onXhr&&f.onXhr(i,e),i.onreadystatechange=function(t){var n,a;4===i.readyState&&(n=i.status||0,n>399&&600>n?(a=new Error(e+" HTTP status: "+n),a.xhr=i,s&&s(a)):r(i.responseText),f.onXhrComplete&&f.onXhrComplete(i,e))},i.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var r,s,n="utf-8",a=new java.io.File(e),i=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(a),n)),p="";try{for(r=new java.lang.StringBuffer,s=o.readLine(),s&&s.length()&&65279===s.charAt(0)&&(s=s.substring(1)),null!==s&&r.append(s);null!==(s=o.readLine());)r.append(i),r.append(s);p=String(r.toString())}finally{o.close()}t(p)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(s=Components.classes,n=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in s,t.get=function(e,t){var r,i,o,p={};a&&(e=e.replace(/\//g,"\\")),o=new FileUtils.File(e);try{r=s["@mozilla.org/network/file-input-stream;1"].createInstance(n.nsIFileInputStream),r.init(o,1,0,!1),i=s["@mozilla.org/intl/converter-input-stream;1"].createInstance(n.nsIConverterInputStream),i.init(r,"utf-8",r.available(),n.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),i.readString(r.available(),p),i.close(),r.close(),t(p.value)}catch(c){throw new Error((o&&o.path||"")+": "+c)}}),t}),define("text!sample/gadgets/sample-products-list/sample-products-list.html",[],function(){return'{{#each products}}\n<div class="media">\n    <div class="media-left">\n        <a href="#" class="media-popup" data-media-index="{{@index}}">\n            <img class="media-object" src="{{imageUrl128}}" alt="{{title}}">\n        </a>\n    </div>\n    <div class="media-body">\n        <h4 class="media-heading">\n            <a href="{{browseUrl}}">{{title}}</a>\n        </h4>\n        {{description}}\n    </div>\n</div>\n{{/each}}'}),define("sample/gadgets/sample-products-list/sample-products-list.js",["require","exports","module","css!./sample-products-list.css","text!./sample-products-list.html","ratchet/dynamic/empty","ui"],function(e,t,r){e("css!./sample-products-list.css");var s=e("text!./sample-products-list.html"),n=e("ratchet/dynamic/empty"),a=e("ui");return a.registerGadget("sample-products-list",n.extend({TEMPLATE:s,setup:function(){this.get("/projects/{projectId}/products",this.index)},prepareModel:function(e,t,r){var s=this.observable("project").get(),n=this.observable("branch").get();this.base(e,t,function(){n.queryNodes({_type:"catalog:product"}).then(function(){t.products=this.asArray();for(var e=0;e<t.products.length;e++){var n=t.products[e];n.imageUrl256="/preview/repository/"+n.getRepositoryId()+"/branch/"+n.getBranchId()+"/node/"+n.getId()+"/default?size=256&name=preview256&force=true",n.imageUrl128="/preview/repository/"+n.getRepositoryId()+"/branch/"+n.getBranchId()+"/node/"+n.getId()+"/default?size=128&name=preview128&force=true",n.browseUrl="/#/projects/"+s._doc+"/documents/"+n._doc}r()})})},afterSwap:function(e,t,r,s){this.base(e,t,r,function(){$(e).find(".media-popup").click(function(e){e.preventDefault();var r=$(this).attr("data-media-index"),s=t.products[r];a.showPopupModal({title:"Viewing: "+s.title,body:"<div style='text-align:center'><img src='"+s.imageUrl+"'></div>"})}),s()})}}))}),define("text!sample/gadgets/sample-random-product-dashlet/sample-random-product-dashlet.html",[],function(){return'<div>\n\n    <div style="text-align:center">\n\n        <p>{{product.title}}</p>\n\n        <a href="/#/projects/{{project._doc}}/documents/{{product._doc}}">\n            <img src="{{product.imageUrl}}" alt="{{product.title}}">\n        </a>\n\n    </div>\n\n</div>\n'}),define("css!sample/gadgets/sample-random-product-dashlet/sample-random-product-dashlet",[],function(){}),define("sample/gadgets/sample-random-product-dashlet/sample-random-product-dashlet.js",["require","exports","module","text!./sample-random-product-dashlet.html","css!./sample-random-product-dashlet.css","ui"],function(e,t,r){var s=e("text!./sample-random-product-dashlet.html");e("css!./sample-random-product-dashlet.css");var n=e("ui");return n.registerDashlet("sample-random-product-dashlet",n.AbstractDashlet.extend({TEMPLATE:s,prepareModel:function(e,t,r){var s=this.observable("branch").get();this.base(e,t,function(){s.queryNodes({_type:"catalog:product"}).then(function(){var e=this.asArray(),s=t.product=e[Math.floor(Math.random()*e.length)];s.imageUrl="/preview/repository/"+s.getRepositoryId()+"/branch/"+s.getBranchId()+"/node/"+s.getId()+"/default?size=256&name=preview256",r()})})},afterSwap:function(e,t,r,s){this.base(e,t,r,function(){s()})}}))}),define("sample/actions/sample/create-sample-space.js",["require","exports","module","ui","content-helpers"],function(e,t,r){var s=e("ui"),n=e("content-helpers");return s.registerAction("create-sample-space",s.AbstractUIAction.extend({defaultConfiguration:function(){var e=this.base();return e.title="Create Sample Space",e.iconClass="fa fa-plus",e},prepareAction:function(e,t,r){e.currentPath=e.observable("path").get(),r()},executeAction:function(e,t,r){var n=this,a={data:{title:"My Sample Space",description:"Description of my sample space"},schema:{type:"object",properties:{title:{type:"string",required:!0},description:{type:"string"}}},options:{fields:{title:{type:"text",label:"Title"},description:{type:"textarea",label:"Description"}},focus:"title"}};s.renderForm(a,function(r){s.showModal({title:t.title,form:r,buttons:[{id:"create",title:"Create",handler:function(t){s.showWaitModal("Creating the sample space...",function(){n.createHandler(e,r.getValue(),function(){s.hideWaitModal()})})}}],bindFormEnterKeyToButton:"create",cancel:!0},function(e){})})},createHandler:function(e,t,r){n.addContent(e,[{type:"folder",properties:t,parentFolderPath:e.currentPath},{type:"folder",properties:{title:"Files"},parentFolderPath:e.currentPath+"/"+t.title},{type:"file",properties:{title:"helloworld.txt"},parentFolderPath:e.currentPath+"/"+t.title+"/Files",text:"Hello World!"}],function(e){r()})}}))}),define("sample/fields/sample-city-picker.js",["require","exports","module","ui","alpaca","jquery"],function(e,t,r){var s=e("ui"),n=e("alpaca"),a=e("jquery");return s.registerField("sample-city-picker",n.Fields.SelectField.extend({setup:function(){this.base(),this.options.dataSource=function(e){a.ajax({method:"GET",url:"https://raw.githubusercontent.com/gitana/cloudcms-ui-sample-addon/master/data/cities.json",dataType:"json"}).done(function(t){e(t.cities)})}}}))}),define("sample/fields/sample-content-picker.js",["require","exports","module","ui","alpaca"],function(e,t,r){var s=e("ui"),n=e("alpaca");return s.registerField("sample-content-picker",n.Fields.SelectField.extend({setup:function(){this.base(),this.options.contentType||(this.options.contentType="catalog:product"),this.options.dataSource={connector:!0,config:{query:{_type:this.options.contentType},mappings:{value:"_doc",text:"title"}}}}}))}),define("sample/gadgets/sample-product-document-properties/sample-product-document-properties.js",["require","exports","module","app/gadgets/project/document/view/document-properties","ui"],function(e,t,r){var s=e("app/gadgets/project/document/view/document-properties"),n=e("ui");return n.registerGadget("sample-product-document-properties",s.extend({determinePropertyDisplaySettings:function(e,t){return"catalog:product"===e.getTypeQName()&&"sku"===t?{link:"https://www.wickedgoodcupcakes.com"}:this.base()}}))}),define("css!sample/styles/sample",[],function(){}),define("sample/index",["require","./gadgets/sample-products-list/sample-products-list.js","./gadgets/sample-random-product-dashlet/sample-random-product-dashlet.js","./actions/sample/create-sample-space.js","./fields/sample-city-picker.js","./fields/sample-content-picker.js","./gadgets/sample-product-document-properties/sample-product-document-properties.js","css!./styles/sample.css"],function(e){e("./gadgets/sample-products-list/sample-products-list.js"),e("./gadgets/sample-random-product-dashlet/sample-random-product-dashlet.js"),e("./actions/sample/create-sample-space.js"),e("./fields/sample-city-picker.js"),e("./fields/sample-content-picker.js"),e("./gadgets/sample-product-document-properties/sample-product-document-properties.js"),e("css!./styles/sample.css")}),function(e){var t=document,r="appendChild",s="styleSheet",n=t.createElement("style");n.type="text/css",t.getElementsByTagName("head")[0][r](n),n[s]?n[s].cssText=e:n[r](t.createTextNode(e))}(".dashlet.sample-dashlet .dashlet-body > div\n{\n    padding: 10px;\n}\n"),require(["sample/index"]);