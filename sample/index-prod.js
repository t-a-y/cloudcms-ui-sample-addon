/**
 * @license RequireJS text 2.0.14 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

define("css!sample/gadgets/sample-products-list/sample-products-list",[],function(){}),define("text",["module"],function(e){"use strict";var t,n,s,i,r,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l="undefined"!=typeof location&&location.href,d=l&&location.protocol&&location.protocol.replace(/\:/,""),p=l&&location.hostname,u=l&&(location.port||void 0),m={},f=e.config&&e.config()||{};return t={version:"2.0.14",strip:function(e){if(e){e=e.replace(a,"");var t=e.match(c);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(s){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,s,i=!1,r=e.lastIndexOf("."),o=0===e.indexOf("./")||0===e.indexOf("../");return-1!==r&&(!o||r>1)?(t=e.substring(0,r),n=e.substring(r+1)):t=e,s=n||t,r=s.indexOf("!"),-1!==r&&(i="strip"===s.substring(r+1),s=s.substring(0,r),n?n=s:t=s),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,s,i){var r,o,a,c=t.xdRegExp.exec(e);return c?(r=c[2],o=c[3],o=o.split(":"),a=o[1],o=o[0],!(r&&r!==n||o&&o.toLowerCase()!==s.toLowerCase()||(a||o)&&a!==i)):!0},finishLoad:function(e,n,s,i){s=n?t.strip(s):s,f.isBuild&&(m[e]=s),i(s)},load:function(e,n,s,i){if(i&&i.isBuild&&!i.inlineText)return void s();f.isBuild=i&&i.isBuild;var r=t.parseName(e),o=r.moduleName+(r.ext?"."+r.ext:""),a=n.toUrl(o),c=f.useXhr||t.useXhr;return 0===a.indexOf("empty:")?void s():void(!l||c(a,d,p,u)?t.get(a,function(n){t.finishLoad(e,r.strip,n,s)},function(e){s.error&&s.error(e)}):n([o],function(e){t.finishLoad(r.moduleName+"."+r.ext,r.strip,e,s)}))},write:function(e,n,s,i){if(m.hasOwnProperty(n)){var r=t.jsEscape(m[n]);s.asModule(e+"!"+n,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,n,s,i,r){var o=t.parseName(n),a=o.ext?"."+o.ext:"",c=o.moduleName+a,l=s.toUrl(o.moduleName+a)+".js";t.load(c,s,function(n){var s=function(e){return i(l,e)};s.asModule=function(e,t){return i.asModule(e,l,t)},t.write(e,c,s,r)},r)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(n=require.nodeRequire("fs"),t.get=function(e,t,s){try{var i=n.readFileSync(e,"utf8");"\ufeff"===i[0]&&(i=i.substring(1)),t(i)}catch(r){s&&s(r)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,n,s,i){var r,o=t.createXhr();if(o.open("GET",e,!0),i)for(r in i)i.hasOwnProperty(r)&&o.setRequestHeader(r.toLowerCase(),i[r]);f.onXhr&&f.onXhr(o,e),o.onreadystatechange=function(t){var i,r;4===o.readyState&&(i=o.status||0,i>399&&600>i?(r=new Error(e+" HTTP status: "+i),r.xhr=o,s&&s(r)):n(o.responseText),f.onXhrComplete&&f.onXhrComplete(o,e))},o.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,s,i="utf-8",r=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),i)),c="";try{for(n=new java.lang.StringBuffer,s=a.readLine(),s&&s.length()&&65279===s.charAt(0)&&(s=s.substring(1)),null!==s&&n.append(s);null!==(s=a.readLine());)n.append(o),n.append(s);c=String(n.toString())}finally{a.close()}t(c)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(s=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),r="@mozilla.org/windows-registry-key;1"in s,t.get=function(e,t){var n,o,a,c={};r&&(e=e.replace(/\//g,"\\")),a=new FileUtils.File(e);try{n=s["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(a,1,0,!1),o=s["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),c),o.close(),n.close(),t(c.value)}catch(l){throw new Error((a&&a.path||"")+": "+l)}}),t}),define("text!sample/gadgets/sample-products-list/sample-products-list.html",[],function(){return'{{#each products}}\n<div class="media">\n    <div class="media-left">\n        <a href="#" class="media-popup" data-media-index="{{@index}}">\n            <img class="media-object" src="{{imageUrl128}}" alt="{{title}}">\n        </a>\n    </div>\n    <div class="media-body">\n        <h4 class="media-heading">\n            <a href="{{browseUrl}}">{{title}}</a>\n        </h4>\n        {{description}}\n    </div>\n</div>\n{{/each}}'}),define("sample/gadgets/sample-products-list/sample-products-list.js",["require","exports","module","css!./sample-products-list.css","text!./sample-products-list.html","ratchet/dynamic/empty","ui"],function(e,t,n){e("css!./sample-products-list.css");var s=e("text!./sample-products-list.html"),i=e("ratchet/dynamic/empty"),r=e("ui");return r.registerGadget("sample-products-list",i.extend({TEMPLATE:s,setup:function(){this.get("/projects/{projectId}/products",this.index)},prepareModel:function(e,t,n){var s=this.observable("project").get(),i=this.observable("branch").get();this.base(e,t,function(){i.queryNodes({_type:"catalog:product"}).then(function(){t.products=this.asArray();for(var e=0;e<t.products.length;e++){var i=t.products[e];i.imageUrl256="/preview/repository/"+i.getRepositoryId()+"/branch/"+i.getBranchId()+"/node/"+i.getId()+"/default?size=256&name=preview256&force=true",i.imageUrl128="/preview/repository/"+i.getRepositoryId()+"/branch/"+i.getBranchId()+"/node/"+i.getId()+"/default?size=128&name=preview128&force=true",i.browseUrl="/#/projects/"+s._doc+"/documents/"+i._doc}n()})})},afterSwap:function(e,t,n,s){this.base(e,t,n,function(){$(e).find(".media-popup").click(function(e){e.preventDefault();var n=$(this).attr("data-media-index"),s=t.products[n];r.showPopupModal({title:"Viewing: "+s.title,body:"<div style='text-align:center'><img src='"+s.imageUrl+"'></div>"})}),s()})}}))}),define("text!sample/gadgets/sample-random-product-dashlet/sample-random-product-dashlet.html",[],function(){return'<div>\n\n    <div style="text-align:center">\n\n        <p>{{product.title}}</p>\n\n        <a href="/#/projects/{{project._doc}}/documents/{{product._doc}}">\n            <img src="{{product.imageUrl}}" alt="{{product.title}}">\n        </a>\n\n    </div>\n\n</div>\n'}),define("css!sample/gadgets/sample-random-product-dashlet/sample-random-product-dashlet",[],function(){}),define("sample/gadgets/sample-random-product-dashlet/sample-random-product-dashlet.js",["require","exports","module","text!./sample-random-product-dashlet.html","css!./sample-random-product-dashlet.css","ui"],function(e,t,n){var s=e("text!./sample-random-product-dashlet.html");e("css!./sample-random-product-dashlet.css");var i=e("ui");return i.registerDashlet("sample-random-product-dashlet",i.AbstractDashlet.extend({TEMPLATE:s,prepareModel:function(e,t,n){var s=this.observable("branch").get();this.base(e,t,function(){s.queryNodes({_type:"catalog:product"}).then(function(){var e=this.asArray(),s=t.product=e[Math.floor(Math.random()*e.length)];s.imageUrl="/preview/repository/"+s.getRepositoryId()+"/branch/"+s.getBranchId()+"/node/"+s.getId()+"/default?size=256&name=preview256",n()})})},afterSwap:function(e,t,n,s){this.base(e,t,n,function(){s()})}}))}),define("sample/gadgets/tay-project-dashboard/tay-content-instances.js",["require","exports","module"],function(e,t,n){var s=e("ratchet/web"),i=e("ratchet/dynamic/doclist"),r=e("oneteam");return s.Messages.using(),s.GadgetRegistry.register("tay-content-instances",i.extend({configureDefault:function(){this.base();var e={columnHeaders:!0,buttons:[{key:"create-content",title:"Create Content",iconClass:"fa fa-plus",align:"left",action:"create-content",allowPermission:["create"],category:"capabilities-check"}],navbox:!1,defaultFirstColumnAsId:!0,options:{filter:!0,paginate:!0,info:!0,sizing:!0,processing:!0},observables:{query:"content-instances-list_query",sort:"content-instances-list_sort",sortDirection:"content-instances-list_sortDirection",searchTerm:"content-instances-list_searchTerm",selectedItems:"content-instances-list_selectedItems",length:"length",optionsFilter:"optionsFilter",refresh:"refresh_content-instances_gadget132"},checkbox:!0,icon:!0,columns:[{key:"titleDescription",title:"Content Instance"}],loader:"gitana",lengthMenu:{values:[10,25,50,100,999999],labels:[10,25,50,100,"All"]},selectorGroups:{"multi-documents-action-selector-group":{actions:[{action:"delete-content",order:100,_allowPermission:["delete"]},{action:"edit-content",order:200,_allowPermission:["update"]},{action:"start-workflow",order:300,_allowAuthority:["collaborator","contributor","editor","manager"]}]},"single-document-action-selector-group":{actions:[]},"sort-selector-group":{fields:[{key:"title",title:"Title",field:"title"},{key:"description",title:"Description",field:"description"},{key:"createdOn",title:"Created On",field:"_system.created_on.ms"},{key:"createdBy",title:"Created By",field:"_system.created_by"},{key:"modifiedOn",title:"Modified On",field:"_system.modified_on.ms"},{key:"modifiedBy",title:"Modified By",field:"_system.modified_by"},{key:"type",title:"Type",field:"TYPE"},{key:"size",title:"Size",field:"size"}]},"options-filter":{options:[]}},chrome:!1,cssClasses:" content-instances",tokens:{projectId:"e1b5b4592c39d60bae02"},route:{method:"GET",uri:"/projects/e1b5b4592c39d60bae02/content"},uri:"/projects/e1b5b4592c39d60bae02/content",method:"GET",items:[],originalSelectorGroups:{"multi-documents-action-selector-group":{actions:[{action:"delete-content",order:100,_allowPermission:["delete"]},{action:"edit-content",order:200,_allowPermission:["update"]},{action:"start-workflow",order:300,_allowAuthority:["collaborator","contributor","editor","manager"]}]},"single-document-action-selector-group":{actions:[]},"sort-selector-group":{fields:[{key:"title",title:"Title",field:"title"},{key:"description",title:"Description",field:"description"},{key:"createdOn",title:"Created On",field:"_system.created_on.ms"},{key:"createdBy",title:"Created By",field:"_system.created_by"},{key:"modifiedOn",title:"Modified On",field:"_system.modified_on.ms"},{key:"modifiedBy",title:"Modified By",field:"_system.modified_by"},{key:"type",title:"Type",field:"TYPE"},{key:"size",title:"Size",field:"size"}]},"options-filter":{options:[]}}};this.config(e)},setup:function(){this.get("/projects/{projectId}/tay/content",this.index),this.get("/projects/{projectId}/tay/content/{qname}",this.index)},entityTypes:function(){return{plural:"content instances",singular:"content instance"}},beforeSwap:function(e,t,n){var s=this;this.base(e,t,function(){var t=s.refreshHandler(e);s.subscribe("selected-content-type",t),n()})},checkPermission:function(e,t,n,s){var i=this.base(e,t,n,s);if("capabilities-check"===s.category){i=!1;var r=e.observable("selected-content-type").get();r&&r.capabilities&&("create_subobjects"===n&&(n="create"),i=r.capabilities.contains(n))}return i},afterSwap:function(e,t,n,s){var i=this;this.base(e,t,n,function(){var e=i.observable("selected-content-type").get();e||$(".btn.list-button-create-content").hide(),s()})},doGitanaQuery:function(e,t,n,s,i,o){var a=this;a.observable("project").get(),r.isEmptyOrNonExistent(s)&&n&&(s=r.searchQuery(n,["title","description"])),s||(s={}),r.projectBranch(a,function(){var e=a.observable("selected-content-type").get();return e?(s._type=e.definition.getQName(),void this.queryNodes(s,i).then(function(){o(this)})):o(new Gitana.NodeMap(this))})},linkUri:function(e,t,n){var s=n.tokens.projectId;return"#/projects/"+s+"/documents/"+e._doc},iconUri:function(e,t,n){return r.iconUriForNode(e)},columnValue:function(e,t,n,s){var i=this,o=i.observable("project").get(),a=this.base(e,t);if("titleDescription"==t.key){var c=r.buildNodeSummary(e,!1,o);a=r.listTitleDescription(s,e,null,null,!1,c);var l="False";e.published&&(l="True"),a+="<div>Published : "+l+"</div>"}return a}}))}),define("text!sample/gadgets/tay-project-dashboard/content-types.html",[],function(){return'"<div class="content-types">\n    {{#if chrome}}\n    <div class="chrome chrome-header">\n        <div class="chrome-title">{{chrome.title}}</div>\n    </div>\n    <div class="chrome chrome-body">\n        {{/if}}\n\n        <nav class="navmenu navmenu-default navmenu-fixed-left offcanvas-sm" role="navigation">\n\n            {{#compare types.length 0}}\n            <div class="no-content-types">\n                There are no content types configured.\n                <br/>\n                <br/>\n                <a href="#/projects/{{projectId}}/definitions">Configure Content Types...</a>\n            </div>\n            {{/compare}}\n\n            {{#greaterThan types.length 0}}\n            <ul class="nav navmenu-nav">\n\n                <li class="header">\n                    <span>Content Types</span>\n                </li>\n\n                {{#each types}}\n                <li class="{{#if current}}active{{/if}} {{#if cssClass}}{{cssClass}}{{/if}}">\n                    <a href="/#/projects/{{../projectId}}/tay/content/{{qname}}" class="content-type-link" data-dispatch-uri="/projects/{{../projectId}}/tay/content/{{qname}}" title="{{title}}">\n                        <i class="icon {{#if iconClass}}{{iconClass}}{{else}}fa fa-angle-right{{/if}}"></i>\n                        <span>{{displayTitle}}</span>\n                    </a>\n                </li>\n                {{/each}}\n\n            </ul>\n            {{/greaterThan}}\n\n        </nav>\n\n\n        {{#if chrome}}\n    </div>\n    {{/if}}\n</div>'}),define("sample/gadgets/tay-project-dashboard/tay-entity-types.js",["require","exports","module","text!./content-types.html","ratchet/web","oneteam","ratchet/dynamic/empty"],function(e,t,n){var s=e("text!./content-types.html"),i=e("ratchet/web"),r=e("oneteam"),o=e("ratchet/dynamic/empty");return i.GadgetRegistry.register("tay-entity-types",o.extend({TEMPLATE:s,configureDefault:function(){this.base()},setup:function(){this.get("/projects/{projectId}/tay/content",this.index),this.get("/projects/{projectId}/tay/content/{qname}",this.index)},prepareModel:function(e,t,n){var s=this;this.base(e,t,function(){var e=s.observable("project").get();t.projectId=e.getId(),t.types=[],r.projectContentTypes(s,function(r,o){for(var a=[],c=0;c<r.length;c++){var l=r[c];l.definition.systemBootstrapped||("undefined"!=typeof l.capabilities?l.capabilities.indexOf("read")>-1?a.push(l):console.log("Filtering off: "+l+" because lacks READ capability"):a.push(l))}r=a,e.contentTypeSortByTitle&&r.sort(function(e,t){return e.title.localeCompare(t.title)}),e.contentTypesSortField&&r.sort(function(t,n){var s=i.resolveDotNotation(t.definition,e.contentTypesSortField)||"",r=i.resolveDotNotation(n.definition,e.contentTypesSortField)||"";return s.localeCompare(r)});for(var d=0;d<r.length;d++)r[d].displayTitle=r[d].title,e.contentTypesDisplayField&&(r[d].displayTitle=i.resolveDotNotation(r[d].definition,e.contentTypesDisplayField)||r[d].title);var p=t.tokens.qname;if(p){for(var u=null,c=0;c<r.length;c++)if(r[c].qname===p){u=r[c];break}u&&s.observable("selected-content-type").set(u)}var m=s.observable("selected-content-type").get();!m&&r&&r.length>0&&s.observable("selected-content-type").set(r[0]);var f=null,h=s.observable("selected-content-type").get();h&&(f=h.definition.getQName());for(var c=0;c<r.length;c++)h||(h=r[c],f=r[c].qname),f==r[c].qname&&(r[c].current=!0),t.types=r;n()})})},afterSwap:function(e,t,n,s){var i=this;this.base(e,t,n,function(){$(e).find("li.header").first().addClass("header-first"),i.observable("project").get(),$(e).find(".content-type-link").off().click(function(e){e.preventDefault();var t=$(this).attr("data-dispatch-uri");i.topRatchet().run(t)}),s()})}}))}),define("sample/actions/sample/create-sample-space.js",["require","exports","module","ui","content-helpers"],function(e,t,n){var s=e("ui"),i=e("content-helpers");return s.registerAction("create-sample-space",s.AbstractUIAction.extend({defaultConfiguration:function(){var e=this.base();return e.title="Create Sample Space",e.iconClass="fa fa-plus",e},prepareAction:function(e,t,n){e.currentPath=e.observable("path").get(),n()},executeAction:function(e,t,n){var i=this,r={data:{title:"My Sample Space",description:"Description of my sample space"},schema:{type:"object",properties:{title:{type:"string",required:!0},description:{type:"string"}}},options:{fields:{title:{type:"text",label:"Title"},description:{type:"textarea",label:"Description"}},focus:"title"}};s.renderForm(r,function(n){s.showModal({title:t.title,form:n,buttons:[{id:"create",title:"Create",handler:function(t){s.showWaitModal("Creating the sample space...",function(){i.createHandler(e,n.getValue(),function(){s.hideWaitModal()})})}}],bindFormEnterKeyToButton:"create",cancel:!0},function(e){})})},createHandler:function(e,t,n){i.addContent(e,[{type:"folder",properties:t,parentFolderPath:e.currentPath},{type:"folder",properties:{title:"Files"},parentFolderPath:e.currentPath+"/"+t.title},{type:"file",properties:{title:"helloworld.txt"},parentFolderPath:e.currentPath+"/"+t.title+"/Files",text:"Hello World!"}],function(e){n()})}}))}),define("sample/fields/sample-city-picker.js",["require","exports","module","ui","alpaca","jquery"],function(e,t,n){var s=e("ui"),i=e("alpaca"),r=e("jquery");return s.registerField("sample-city-picker",i.Fields.SelectField.extend({setup:function(){this.base(),this.options.dataSource=function(e){r.ajax({method:"GET",url:"https://raw.githubusercontent.com/gitana/cloudcms-ui-sample-addon/master/data/cities.json",dataType:"json"}).done(function(t){e(t.cities)})}}}))}),define("sample/fields/sample-content-picker.js",["require","exports","module","ui","alpaca"],function(e,t,n){var s=e("ui"),i=e("alpaca");return s.registerField("sample-content-picker",i.Fields.SelectField.extend({setup:function(){this.base(),this.options.contentType||(this.options.contentType="catalog:product"),this.options.dataSource={connector:!0,config:{query:{_type:this.options.contentType},mappings:{value:"_doc",text:"title"}}}}}))}),define("sample/gadgets/sample-product-document-properties/sample-product-document-properties.js",["require","exports","module","app/gadgets/project/document/view/document-properties","ui"],function(e,t,n){var s=e("app/gadgets/project/document/view/document-properties"),i=e("ui");return i.registerGadget("sample-product-document-properties",s.extend({determinePropertyDisplaySettings:function(e,t){return"catalog:product"===e.getTypeQName()&&"sku"===t?{link:"https://www.wickedgoodcupcakes.com"}:this.base()}}))}),define("css!sample/styles/sample",[],function(){}),define("sample/index",["require","./gadgets/sample-products-list/sample-products-list.js","./gadgets/sample-random-product-dashlet/sample-random-product-dashlet.js","./gadgets/tay-project-dashboard/tay-content-instances.js","./gadgets/tay-project-dashboard/tay-entity-types.js","./actions/sample/create-sample-space.js","./fields/sample-city-picker.js","./fields/sample-content-picker.js","./gadgets/sample-product-document-properties/sample-product-document-properties.js","css!./styles/sample.css"],function(e){e("./gadgets/sample-products-list/sample-products-list.js"),e("./gadgets/sample-random-product-dashlet/sample-random-product-dashlet.js"),e("./gadgets/tay-project-dashboard/tay-content-instances.js"),e("./gadgets/tay-project-dashboard/tay-entity-types.js"),e("./actions/sample/create-sample-space.js"),e("./fields/sample-city-picker.js"),e("./fields/sample-content-picker.js"),e("./gadgets/sample-product-document-properties/sample-product-document-properties.js"),e("css!./styles/sample.css")}),function(e){var t=document,n="appendChild",s="styleSheet",i=t.createElement("style");i.type="text/css",t.getElementsByTagName("head")[0][n](i),i[s]?i[s].cssText=e:i[n](t.createTextNode(e))}(".dashlet.sample-dashlet .dashlet-body > div\n{\n    padding: 10px;\n}\n"),require(["sample/index"]);