/**
 * @license RequireJS text 2.0.14 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

define("css!sample/gadgets/sample-products-list/sample-products-list",[],function(){}),define("text",["module"],function(e){"use strict";var t,n,s,r,a,i=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l="undefined"!=typeof location&&location.href,p=l&&location.protocol&&location.protocol.replace(/\:/,""),d=l&&location.hostname,u=l&&(location.port||void 0),m={},f=e.config&&e.config()||{};return t={version:"2.0.14",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(c);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=i[t];try{e=new ActiveXObject(n)}catch(s){}if(e){i=[n];break}}return e},parseName:function(e){var t,n,s,r=!1,a=e.lastIndexOf("."),i=0===e.indexOf("./")||0===e.indexOf("../");return-1!==a&&(!i||a>1)?(t=e.substring(0,a),n=e.substring(a+1)):t=e,s=n||t,a=s.indexOf("!"),-1!==a&&(r="strip"===s.substring(a+1),s=s.substring(0,a),n?n=s:t=s),{moduleName:t,ext:n,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,s,r){var a,i,o,c=t.xdRegExp.exec(e);return c?(a=c[2],i=c[3],i=i.split(":"),o=i[1],i=i[0],!(a&&a!==n||i&&i.toLowerCase()!==s.toLowerCase()||(o||i)&&o!==r)):!0},finishLoad:function(e,n,s,r){s=n?t.strip(s):s,f.isBuild&&(m[e]=s),r(s)},load:function(e,n,s,r){if(r&&r.isBuild&&!r.inlineText)return void s();f.isBuild=r&&r.isBuild;var a=t.parseName(e),i=a.moduleName+(a.ext?"."+a.ext:""),o=n.toUrl(i),c=f.useXhr||t.useXhr;return 0===o.indexOf("empty:")?void s():void(!l||c(o,p,d,u)?t.get(o,function(n){t.finishLoad(e,a.strip,n,s)},function(e){s.error&&s.error(e)}):n([i],function(e){t.finishLoad(a.moduleName+"."+a.ext,a.strip,e,s)}))},write:function(e,n,s,r){if(m.hasOwnProperty(n)){var a=t.jsEscape(m[n]);s.asModule(e+"!"+n,"define(function () { return '"+a+"';});\n")}},writeFile:function(e,n,s,r,a){var i=t.parseName(n),o=i.ext?"."+i.ext:"",c=i.moduleName+o,l=s.toUrl(i.moduleName+o)+".js";t.load(c,s,function(n){var s=function(e){return r(l,e)};s.asModule=function(e,t){return r.asModule(e,l,t)},t.write(e,c,s,a)},a)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(n=require.nodeRequire("fs"),t.get=function(e,t,s){try{var r=n.readFileSync(e,"utf8");"\ufeff"===r[0]&&(r=r.substring(1)),t(r)}catch(a){s&&s(a)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,n,s,r){var a,i=t.createXhr();if(i.open("GET",e,!0),r)for(a in r)r.hasOwnProperty(a)&&i.setRequestHeader(a.toLowerCase(),r[a]);f.onXhr&&f.onXhr(i,e),i.onreadystatechange=function(t){var r,a;4===i.readyState&&(r=i.status||0,r>399&&600>r?(a=new Error(e+" HTTP status: "+r),a.xhr=i,s&&s(a)):n(i.responseText),f.onXhrComplete&&f.onXhrComplete(i,e))},i.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,s,r="utf-8",a=new java.io.File(e),i=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(a),r)),c="";try{for(n=new java.lang.StringBuffer,s=o.readLine(),s&&s.length()&&65279===s.charAt(0)&&(s=s.substring(1)),null!==s&&n.append(s);null!==(s=o.readLine());)n.append(i),n.append(s);c=String(n.toString())}finally{o.close()}t(c)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(s=Components.classes,r=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in s,t.get=function(e,t){var n,i,o,c={};a&&(e=e.replace(/\//g,"\\")),o=new FileUtils.File(e);try{n=s["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream),n.init(o,1,0,!1),i=s["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream),i.init(n,"utf-8",n.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),i.readString(n.available(),c),i.close(),n.close(),t(c.value)}catch(l){throw new Error((o&&o.path||"")+": "+l)}}),t}),define("text!sample/gadgets/sample-products-list/sample-products-list.html",[],function(){return'{{#each products}}\n<div class="media">\n    <div class="media-left">\n        <a href="#" class="media-popup" data-media-index="{{@index}}">\n            <img class="media-object" src="{{imageUrl128}}" alt="{{title}}">\n        </a>\n    </div>\n    <div class="media-body">\n        <h4 class="media-heading">\n            <a href="{{browseUrl}}">{{title}}</a>\n        </h4>\n        {{description}}\n    </div>\n</div>\n{{/each}}'}),define("sample/gadgets/sample-products-list/sample-products-list.js",["require","exports","module","css!./sample-products-list.css","text!./sample-products-list.html","ratchet/dynamic/empty","ui"],function(e,t,n){e("css!./sample-products-list.css");var s=e("text!./sample-products-list.html"),r=e("ratchet/dynamic/empty"),a=e("ui");return a.registerGadget("sample-products-list",r.extend({TEMPLATE:s,setup:function(){this.get("/projects/{projectId}/products",this.index)},prepareModel:function(e,t,n){var s=this.observable("project").get(),r=this.observable("branch").get();this.base(e,t,function(){r.queryNodes({_type:"catalog:product"}).then(function(){t.products=this.asArray();for(var e=0;e<t.products.length;e++){var r=t.products[e];r.imageUrl256="/preview/repository/"+r.getRepositoryId()+"/branch/"+r.getBranchId()+"/node/"+r.getId()+"/default?size=256&name=preview256&force=true",r.imageUrl128="/preview/repository/"+r.getRepositoryId()+"/branch/"+r.getBranchId()+"/node/"+r.getId()+"/default?size=128&name=preview128&force=true",r.browseUrl="/#/projects/"+s._doc+"/documents/"+r._doc}n()})})},afterSwap:function(e,t,n,s){this.base(e,t,n,function(){$(e).find(".media-popup").click(function(e){e.preventDefault();var n=$(this).attr("data-media-index"),s=t.products[n];a.showPopupModal({title:"Viewing: "+s.title,body:"<div style='text-align:center'><img src='"+s.imageUrl+"'></div>"})}),s()})}}))}),define("text!sample/gadgets/sample-random-product-dashlet/sample-random-product-dashlet.html",[],function(){return'<div>\n\n    <div style="text-align:center">\n\n        <p>{{product.title}}</p>\n\n        <a href="/#/projects/{{project._doc}}/documents/{{product._doc}}">\n            <img src="{{product.imageUrl}}" alt="{{product.title}}">\n        </a>\n\n    </div>\n\n</div>\n'}),define("css!sample/gadgets/sample-random-product-dashlet/sample-random-product-dashlet",[],function(){}),define("sample/gadgets/sample-random-product-dashlet/sample-random-product-dashlet.js",["require","exports","module","text!./sample-random-product-dashlet.html","css!./sample-random-product-dashlet.css","ui"],function(e,t,n){var s=e("text!./sample-random-product-dashlet.html");e("css!./sample-random-product-dashlet.css");var r=e("ui");return r.registerDashlet("sample-random-product-dashlet",r.AbstractDashlet.extend({TEMPLATE:s,prepareModel:function(e,t,n){var s=this.observable("branch").get();this.base(e,t,function(){s.queryNodes({_type:"catalog:product"}).then(function(){var e=this.asArray(),s=t.product=e[Math.floor(Math.random()*e.length)];s.imageUrl="/preview/repository/"+s.getRepositoryId()+"/branch/"+s.getBranchId()+"/node/"+s.getId()+"/default?size=256&name=preview256",n()})})},afterSwap:function(e,t,n,s){this.base(e,t,n,function(){s()})}}))}),define("sample/gadgets/tay-project-dashboard/tay-content-instances.js",["require","exports","module"],function(e,t,n){var s=e("ratchet/web"),r=e("ratchet/dynamic/doclist"),a=e("oneteam");return s.Messages.using(),s.GadgetRegistry.register("tay-content-instances",r.extend({configureDefault:function(){this.base(),this.config({observables:{query:"content-instances-list_query",sort:"content-instances-list_sort",sortDirection:"content-instances-list_sortDirection",searchTerm:"content-instances-list_searchTerm",selectedItems:"content-instances-list_selectedItems"}})},setup:function(){this.get("/projects/{projectId}/tay/content",this.index),this.get("/projects/{projectId}/tay/content/{qname}",this.index)},entityTypes:function(){return{plural:"content instances",singular:"content instance"}},beforeSwap:function(e,t,n){var s=this;this.base(e,t,function(){var t=s.refreshHandler(e);s.subscribe("selected-content-type",t),n()})},checkPermission:function(e,t,n,s){var r=this.base(e,t,n,s);if("capabilities-check"===s.category){r=!1;var a=e.observable("selected-content-type").get();a&&a.capabilities&&("create_subobjects"===n&&(n="create"),r=a.capabilities.contains(n))}return r},afterSwap:function(e,t,n,s){var r=this;this.base(e,t,n,function(){var e=r.observable("selected-content-type").get();e||$(".btn.list-button-create-content").hide(),s()})},doGitanaQuery:function(e,t,n,s,r,i){var o=this;o.observable("project").get(),a.isEmptyOrNonExistent(s)&&n&&(s=a.searchQuery(n,["title","description"])),s||(s={}),a.projectBranch(o,function(){var e=o.observable("selected-content-type").get();return e?(s._type=e.definition.getQName(),void this.queryNodes(s,r).then(function(){i(this)})):i(new Gitana.NodeMap(this))})},linkUri:function(e,t,n){var s=n.tokens.projectId;return"#/projects/"+s+"/documents/"+e._doc},iconUri:function(e,t,n){return a.iconUriForNode(e)},columnValue:function(e,t,n,s){var r=this,i=r.observable("project").get(),o=this.base(e,t);if("titleDescription"==t.key){var c=a.buildNodeSummary(e,!1,i);o=a.listTitleDescription(s,e,null,null,!1,c)}return o}}))}),define("text!sample/gadgets/tay-project-dashboard/content-types.html",[],function(){return'"<div class="content-types">\n    {{#if chrome}}\n    <div class="chrome chrome-header">\n        <div class="chrome-title">{{chrome.title}}</div>\n    </div>\n    <div class="chrome chrome-body">\n        {{/if}}\n\n        <nav class="navmenu navmenu-default navmenu-fixed-left offcanvas-sm" role="navigation">\n\n            {{#compare types.length 0}}\n            <div class="no-content-types">\n                There are no content types configured.\n                <br/>\n                <br/>\n                <a href="#/projects/{{projectId}}/definitions">Configure Content Types...</a>\n            </div>\n            {{/compare}}\n\n            {{#greaterThan types.length 0}}\n            <ul class="nav navmenu-nav">\n\n                <li class="header">\n                    <span>Content Types</span>\n                </li>\n\n                {{#each types}}\n                <li class="{{#if current}}active{{/if}} {{#if cssClass}}{{cssClass}}{{/if}}">\n                    <a href="/#/projects/{{../projectId}}/content/{{qname}}" class="content-type-link" data-dispatch-uri="/projects/{{../projectId}}/content/{{qname}}" title="{{title}}">\n                        <i class="icon {{#if iconClass}}{{iconClass}}{{else}}fa fa-angle-right{{/if}}"></i>\n                        <span>{{displayTitle}}</span>\n                    </a>\n                </li>\n                {{/each}}\n\n            </ul>\n            {{/greaterThan}}\n\n        </nav>\n\n\n        {{#if chrome}}\n    </div>\n    {{/if}}\n</div>'}),define("sample/gadgets/tay-project-dashboard/tay-entity-types.js",["require","exports","module","text!./content-types.html","ratchet/web","oneteam","ratchet/dynamic/empty"],function(e,t,n){var s=e("text!./content-types.html"),r=e("ratchet/web"),a=e("oneteam"),i=e("ratchet/dynamic/empty");return r.GadgetRegistry.register("tay-content-types",i.extend({TEMPLATE:s,configureDefault:function(){this.base()},setup:function(){this.get("/projects/{projectId}/tay/content",this.index),this.get("/projects/{projectId}/tay/content/{qname}",this.index)},prepareModel:function(e,t,n){var s=this;this.base(e,t,function(){var e=s.observable("project").get();t.projectId=e.getId(),t.types=[],a.projectContentTypes(s,function(a,i){for(var o=[],c=0;c<a.length;c++){var l=a[c];l.definition.systemBootstrapped||("undefined"!=typeof l.capabilities?l.capabilities.indexOf("read")>-1?o.push(l):console.log("Filtering off: "+l+" because lacks READ capability"):o.push(l))}a=o,e.contentTypeSortByTitle&&a.sort(function(e,t){return e.title.localeCompare(t.title)}),e.contentTypesSortField&&a.sort(function(t,n){var s=r.resolveDotNotation(t.definition,e.contentTypesSortField)||"",a=r.resolveDotNotation(n.definition,e.contentTypesSortField)||"";return s.localeCompare(a)});for(var p=0;p<a.length;p++)a[p].displayTitle=a[p].title,e.contentTypesDisplayField&&(a[p].displayTitle=r.resolveDotNotation(a[p].definition,e.contentTypesDisplayField)||a[p].title);var d=t.tokens.qname;if(d){for(var u=null,c=0;c<a.length;c++)if(a[c].qname===d){u=a[c];break}u&&s.observable("selected-content-type").set(u)}var m=s.observable("selected-content-type").get();!m&&a&&a.length>0&&s.observable("selected-content-type").set(a[0]);var f=null,h=s.observable("selected-content-type").get();h&&(f=h.definition.getQName());for(var c=0;c<a.length;c++)h||(h=a[c],f=a[c].qname),f==a[c].qname&&(a[c].current=!0),t.types=a;n()})})},afterSwap:function(e,t,n,s){var r=this;this.base(e,t,n,function(){$(e).find("li.header").first().addClass("header-first"),r.observable("project").get(),$(e).find(".content-type-link").off().click(function(e){e.preventDefault();var t=$(this).attr("data-dispatch-uri");r.topRatchet().run(t)}),s()})}}))}),define("sample/actions/sample/create-sample-space.js",["require","exports","module","ui","content-helpers"],function(e,t,n){var s=e("ui"),r=e("content-helpers");return s.registerAction("create-sample-space",s.AbstractUIAction.extend({defaultConfiguration:function(){var e=this.base();return e.title="Create Sample Space",e.iconClass="fa fa-plus",e},prepareAction:function(e,t,n){e.currentPath=e.observable("path").get(),n()},executeAction:function(e,t,n){var r=this,a={data:{title:"My Sample Space",description:"Description of my sample space"},schema:{type:"object",properties:{title:{type:"string",required:!0},description:{type:"string"}}},options:{fields:{title:{type:"text",label:"Title"},description:{type:"textarea",label:"Description"}},focus:"title"}};s.renderForm(a,function(n){s.showModal({title:t.title,form:n,buttons:[{id:"create",title:"Create",handler:function(t){s.showWaitModal("Creating the sample space...",function(){r.createHandler(e,n.getValue(),function(){s.hideWaitModal()})})}}],bindFormEnterKeyToButton:"create",cancel:!0},function(e){})})},createHandler:function(e,t,n){r.addContent(e,[{type:"folder",properties:t,parentFolderPath:e.currentPath},{type:"folder",properties:{title:"Files"},parentFolderPath:e.currentPath+"/"+t.title},{type:"file",properties:{title:"helloworld.txt"},parentFolderPath:e.currentPath+"/"+t.title+"/Files",text:"Hello World!"}],function(e){n()})}}))}),define("sample/fields/sample-city-picker.js",["require","exports","module","ui","alpaca","jquery"],function(e,t,n){var s=e("ui"),r=e("alpaca"),a=e("jquery");return s.registerField("sample-city-picker",r.Fields.SelectField.extend({setup:function(){this.base(),this.options.dataSource=function(e){a.ajax({method:"GET",url:"https://raw.githubusercontent.com/gitana/cloudcms-ui-sample-addon/master/data/cities.json",dataType:"json"}).done(function(t){e(t.cities)})}}}))}),define("sample/fields/sample-content-picker.js",["require","exports","module","ui","alpaca"],function(e,t,n){var s=e("ui"),r=e("alpaca");return s.registerField("sample-content-picker",r.Fields.SelectField.extend({setup:function(){this.base(),this.options.contentType||(this.options.contentType="catalog:product"),this.options.dataSource={connector:!0,config:{query:{_type:this.options.contentType},mappings:{value:"_doc",text:"title"}}}}}))}),define("sample/gadgets/sample-product-document-properties/sample-product-document-properties.js",["require","exports","module","app/gadgets/project/document/view/document-properties","ui"],function(e,t,n){var s=e("app/gadgets/project/document/view/document-properties"),r=e("ui");return r.registerGadget("sample-product-document-properties",s.extend({determinePropertyDisplaySettings:function(e,t){return"catalog:product"===e.getTypeQName()&&"sku"===t?{link:"https://www.wickedgoodcupcakes.com"}:this.base()}}))}),define("css!sample/styles/sample",[],function(){}),define("sample/index",["require","./gadgets/sample-products-list/sample-products-list.js","./gadgets/sample-random-product-dashlet/sample-random-product-dashlet.js","./gadgets/tay-project-dashboard/tay-content-instances.js","./gadgets/tay-project-dashboard/tay-entity-types.js","./actions/sample/create-sample-space.js","./fields/sample-city-picker.js","./fields/sample-content-picker.js","./gadgets/sample-product-document-properties/sample-product-document-properties.js","css!./styles/sample.css"],function(e){e("./gadgets/sample-products-list/sample-products-list.js"),e("./gadgets/sample-random-product-dashlet/sample-random-product-dashlet.js"),e("./gadgets/tay-project-dashboard/tay-content-instances.js"),e("./gadgets/tay-project-dashboard/tay-entity-types.js"),e("./actions/sample/create-sample-space.js"),e("./fields/sample-city-picker.js"),e("./fields/sample-content-picker.js"),e("./gadgets/sample-product-document-properties/sample-product-document-properties.js"),e("css!./styles/sample.css")}),function(e){var t=document,n="appendChild",s="styleSheet",r=t.createElement("style");r.type="text/css",t.getElementsByTagName("head")[0][n](r),r[s]?r[s].cssText=e:r[n](t.createTextNode(e))}(".dashlet.sample-dashlet .dashlet-body > div\n{\n    padding: 10px;\n}\n"),require(["sample/index"]);